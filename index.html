<!DOCTYPE html>

<html lang="en" ng-app="App">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<base href="/" target="_blank" />

		<title ng-bind="'Gregory Norton' + (title ? ' - ' + title : '')">
			Gregory Norton
		</title>

		<link rel="stylesheet" href="css/common.css" />
		<link rel="stylesheet" ng-href="{{ css }}" ng-if="css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-route.js"></script>
		
	</head>
	<body>
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark"
			ng-controller="NavController">
			<div class="container-fluid">
				<a class="navbar-brand" href="/">Gregory Norton</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
					data-bs-target="#nav-content" aria-controls="#nav-content"
					aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="nav-content">
					<ul class="navbar-nav me-auto mb-2 mb-lg-0">
						<li class="nav-item" ng-repeat="target in targets"
							ng-class="{ active: isActive(target) }">
							<a class="nav-link" ng-href="{{ target.target }}"
								ng-bind="target.text"></a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<main ng-view=""></main>
		
		<footer>
			<p>Copyright &#169; Gregory Norton 2021</p>
			<!--<a href="/map">Site Map</a>-->
		</footer>

		<!-- load utility libraries -->
		<script src="lib/blog.js"></script>

		<!-- load controllers -->
		<script src="controllers/home.js"></script>
		<script src="controllers/projects.js"></script>
		<script src="controllers/experience.js"></script>
		<script src="controllers/blog.js"></script>
		<script src="controllers/blogpage.js"></script>

		<script>
			var app = angular.module('App', [ 'ngRoute' ]);
			app.config(function ($locationProvider, $routeProvider) {
				$locationProvider.html5Mode(true).hashPrefix('!');
				$routeProvider.when('/', {
					//title: 'Home',
					templateUrl: 'templates/home.html',
					css: 'css/home.css',
					controller: 'HomeController'
				}).when('/projects', {
					title: 'Projects',
					templateUrl: 'templates/projects.html',
					controller: 'ProjectsController'
				}).when('/experience', {
					title: 'Experience',
					templateUrl: 'templates/experience.html',
					controller: 'ExperienceController'
				}).when('/blog', {
					title: 'Blog',
					templateUrl: 'templates/blog.html',
					css: 'css/blog.css',
					controller: 'BlogController'
				}).when('/blog/:article', {
					title: 'Blog',
					templateUrl: 'templates/blogpage.html',
					controller: 'BlogPageController'
				}).otherwise({ redirectTo: '/' });
			});

			app.controller('HomeController', homeController);
			app.controller('ProjectsController', projectsController);
			app.controller('ExperienceController', experienceController);
			app.controller('BlogController', blogController);
			app.controller('BlogPageController', blogPageController);
			app.controller('NavController', function ($scope, $location) {
				$scope.targets = [
					{ text: 'Projects', target: '/projects' },
					{ text: 'Experience', target: '/experience' },
					{ text: 'Blog', target: '/blog' }
				];
				
				$scope.isActive = function (target) {
					return $location.path().startsWith(target.target);
				}
			});
			
			app.value('blogData', { blog: null, currentArticle: null });

			app.run([ '$rootScope', function ($rootScope) {
				$rootScope.$on('$routeChangeSuccess',
					function (event, current, previous) {
					$rootScope.title = current.$$route.title;
					$rootScope.css = current.$$route.css;
				});
			}]);
		</script>
	</body>
</html>
